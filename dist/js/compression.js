/**
 * @license AGPLv3
 * SPDX-License-Identifier: AGPLv3
 * SPDX-FileCopyrightText: Copyright (c) 2026 The Guitar Wiring Visualizer Authors
 */
export const CompressionType=Object.freeze({BROTLI:0,GZIP:1});export async function getCompressor(e){if(isNaN(e)||!Object.values(CompressionType).includes(e))throw new Error("compression type is required");if(e===CompressionType.BROTLI){const e=new BrotliCompressor;return await e.initialize(),e}if(e===CompressionType.GZIP)return Promise.resolve(new GZipCompressor)}class BrotliCompressor{constructor(){if(BrotliCompressor.instance)return BrotliCompressor.instance;this.base64Options={alphabet:"base64url"},this.brotliWasmUrl="https://unpkg.com/brotli-wasm@3.0.0/index.web.js?module",BrotliCompressor.instance=this}async initialize(){if(this.brotli)return Promise.resolve();const e=await import(this.brotliWasmUrl).then(e=>e.default);this.brotli=e}compress(e){const r=(new TextEncoder).encode(e),s=this.brotli.compress(r).toBase64(this.base64Options);return Promise.resolve(s)}decompress(e){const r=Uint8Array.fromBase64(e,this.base64Options),s=this.brotli.decompress(r),o=(new TextDecoder).decode(s);return Promise.resolve(o)}}class GZipCompressor{async compress(e){const r=(new TextEncoder).encode(e),s=new CompressionStream("gzip"),o=s.writable.getWriter();o.write(r),o.close();return(e=>new Promise((r,s)=>{const o=new FileReader;o.onloadend=()=>r(o.result.split(",")[1]),o.readAsDataURL(e)}))(await new Response(s.readable).blob())}async decompress(e){const r=Uint8Array.from(atob(e),e=>e.charCodeAt(0)),s=new DecompressionStream("gzip"),o=s.writable.getWriter();o.write(r),o.close();const t=await new Response(s.readable).arrayBuffer();return(new TextDecoder).decode(t)}}
